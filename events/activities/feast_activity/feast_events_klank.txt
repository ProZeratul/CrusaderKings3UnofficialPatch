
namespace = feast_events_klank

feast_events_klank.1001 = {
	type = activity_event
	title = feast_events_klank.1001.t
	desc = feast_events_klank.1001.desc
	theme = feast_activity
	right_portrait = {
		character = scope:terrified_onlooker
		animation = shock
		camera = camera_event_right_away
	}
	left_portrait = {
		character = root
		animation = scheme
		camera = camera_event_very_left
	}
	center_portrait = {
		character = scope:fellow_torturer
		animation = assassin
		camera = camera_event_very_right
	}
	cooldown = { years = 10 }
	
	trigger = {
		has_trait = torturer
		NOT = {
			has_trait = gluttonous
		}
		involved_activity = {
			any_attending_character = { 
				has_trait = torturer
				is_ai = yes
				opinion = {
					target = root
					value >= medium_positive_opinion #Unop: Was magic number 20 but immediate had medium_positive_opinion leading to undefined characters
				}
				intrigue <= root.intrigue
				NOT = {
					this = root
				}				
			}
			any_attending_character = {
				NOR = {
					has_trait = torturer
					has_trait = callous
					has_trait = sadistic
					this = root
				}
			}
		}
	}

	immediate = {
		set_random_entertainment_text_effect = yes
		involved_activity = {
			random_attending_character = {
				limit = {
					has_trait = torturer
					is_ai = yes
					intrigue <= root.intrigue
					opinion = {
						target = root
						value >= medium_positive_opinion
					}
					NOT = {
						this = root
					}
				}
				save_scope_as = fellow_torturer
			}
			random_attending_character = {
				limit = {
					NOR = {
						has_trait = torturer
						has_trait = callous
						has_trait = sadistic
						#NOT = { #Unop: Why a not here ? we already are in a NOR and we DO want to exclude root !
							this = root
						#}
					}
				}
				save_scope_as = terrified_onlooker
			}
		}
	}

	option = { #nah, the other way is better
		name = feast_events_klank.1001.a
		add_intrigue_lifestyle_xp = major_lifestyle_xp
		
		scope:fellow_torturer = {
			add_intrigue_lifestyle_xp = major_lifestyle_xp
			add_intrigue_skill = 1
		}
	}

	option = { #yeah, you're right
		name = feast_events_klank.1001.b
		progress_towards_friend_effect = {
			REASON = friend_common_interests
			CHARACTER = scope:fellow_torturer
			OPINION = default_friend_opinion
		}
		add_intrigue_lifestyle_xp = minor_lifestyle_xp
		scope:fellow_torturer = {
			add_intrigue_lifestyle_xp = minor_lifestyle_xp
		}
	}

	option = { #actually, I've been thinking recently
		name = feast_events_klank.1001.c

		trigger = {
			learning >= 16
		}

		show_as_unavailable = { always = yes }

		add_intrigue_lifestyle_perk_points = 1
		add_prestige = medium_prestige_gain
		progress_towards_friend_effect = {
			REASON = friend_common_interests
			CHARACTER = scope:fellow_torturer
			OPINION = default_friend_opinion
		}
		scope:fellow_torturer = {
			add_intrigue_lifestyle_perk_points = 1
			add_intrigue_skill = 1
		}

		ai_chance = {
			base = 200
		}
	}
}
